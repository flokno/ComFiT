# Phase Field Crystal

## Basic model

The phase-field crystal methodology is based on postulating a free
energy
$$\mathcal F = \int d\boldsymbol{r} \tilde f(\psi, \nabla \psi, ...),$$
with the goal of the state that minimizes $\mathcal F$ has a certain
symmetry. In this documentation, we will present six such models to
represent different crystalline structures in 1, 2 and 3 dimensions, all
of which are on the form
$$\tilde f( \psi, \nabla \psi, ...) = \frac{1}{2} (\mathcal L(\nabla) \psi)^2 + \frac{1}{2} \texttt{r} \psi^2 + \frac{1}{3} \texttt{t} \psi^3 + \frac{1}{4} \texttt v \psi^4,$$
where $\mathcal L (\nabla)$ is a gradient operator dependent on the
dimension and target symmetry, listed below
|Model| Derivative operator $\mathcal L$|
|-----|---------------------------------|
1D periodic       |$\mathcal L_1 = (1+\nabla^2)$
2D triangular     |$\mathcal L_1 = (1+\nabla^2)$
2D square         |$\mathcal L_1 \mathcal L_2 = (1+\nabla^2) (2+\nabla^2)$
3D bcc            |$\mathcal L_1 = (1+\nabla^2)$
3D fcc            |$\mathcal L_1 \mathcal L_{4/3} = (1+\nabla^2) (4/3+\nabla^2)$
3D simple cubic   |$\mathcal L_1 \mathcal L_2 \mathcal L_3 = (1+\nabla^2) (2+\nabla^2) (3+\nabla^2)$

*Table:* Phase-field crystal models. $\mathcal L_X = (X+\nabla^2)$.


Default values of parameters are $\texttt r=\texttt v = 1$,
$\texttt t=0$.

Historical context: model presented in Ref.
[@elderModelingElasticPlastic2004](References.md).

The primary field is $\psi$, a real valued field

```python
pfc.psi 
```

## Crystal symmetry

This field has the symmetry of a specific lattice, given by a Bravais
lattice, and the simulation domain is fitted to pack an exact number of
these peaks and throughs. Six such symmetries are implemented in the
code, which are given by the primary Bravais lattice vectors (BLVs),
which define the lattice, see this figure

(INSERT FIGURE)

The structure can alternatively be expressed in terms of the reciprocal
lattice vectors (RLVs), which are generated by two *primitive* RLVs
$\{\boldsymbol{q}^{(n)}\}_{n=1}^d$, satisfying

---
$$\boldsymbol{q}^{(n)} \cdot \boldsymbol{a}^{(m)} = 2\pi \delta_{nm}, \quad n,m \leq d$$
The primitive BLV-RLV orthogonality relation.

---

There are infinitely many BLVs and RLVs, but of particular interest are
those with the smallest magnitude; which are sometimes named *primary*
RLVs/BLVs.

These values are encoded in the instance properties `a,q`, e.g.,
```python
import comfit as cf

pfc = cf.PFCtri(1,1)
print(pfc.a)
print(pfc.q)
>> 
[[3.627, 6.283], [7.255, 0.0], [3.627, -6.283]]
[[0, 1], [0.866, -0.5], [-0.866, -0.5]]
```

---
Note the subtle difference between a *primitive* LV and a *primary* LV.
The primitive BLVs generate the lattice and satisfy the orthogonal
relationship with the primitive RLVs which generate the reciprocal
lattice. There are only $d$ primitive LVs in $d$ dimensions whereas
there may be any number of primary lattice vectors. For instance, there
are six primitive BLVs for the triangular lattice and four primitive
lattice vectors for the 2D square lattice. In the following, the primary BLVs and RLVs have
been chosen so that the first $d$ primary LVs are primitive LVs which satisfy the orthogonality relation.

---


### 1D periodic

Lattice constant
$$
a_0 = 2\pi
$$

Primary RLVs

$$
\mathcal R_{\textrm{per}}^{(1)} = 
         
\left \{ 
\begin{array}{l}
    q^{(1)} = 1  \\
    q^{(-1)}= - q^{(1)} 
\end{array}
\right \}
$$ 

Primary BLVs

$$
\mathcal B_{\textrm{per}}^{(1)} = 
         
\left \{ 
\begin{array}{l}
    a^{(1)} = a_0  \\
    a^{(-1)} = -\vec a^{(1)} 
\end{array}
\right \} 
$$




### 2D Triangular

Lattice constant
$$
a_0 = \frac{4\pi}{\sqrt 3}
$$

Primary RLVs
$$ 
\mathcal R_{\textrm{tri}}^{(1)} = 
         {
\left \{ 
\begin{array}{l}
    \vec q^{(1)} = (\sqrt 3/2,-1/2)  \\
    \vec q^{(2)} = (0,1) \\
    \vec q^{(3)} = (-\sqrt 3/2,-1/2) \\ 
    \vec q^{(-n)} = - \vec q^{(n)}|_{n=1,2,3} \\
\end{array}
\right \}
}
$$

Primary BLVs

$$
\mathcal B_{\textrm{tri}}^{(1)} = 
         {
\left \{ 
\begin{array}{l}
    \vec a^{(1)} = a_0(1,0)  \\
    \vec a^{(2)} = a_0(1/2,\sqrt 3/2) \\
    \vec a^{(3)} = a_0(1/2,-\sqrt 3/2) \\ 
    \vec a^{(-n)}=-\vec a^{(n)}|_{n=1,2,3}  \\ 
\end{array}
\right \}
}
$$



### 2D square

Lattice constant
$$
a_0 = 2\pi
$$

Primary RLVs
$$ 
\mathcal R_{\textrm{sq}}^{(1)} = 
         {
\left \{ 
\begin{array}{l}
    \vec q^{(1)} = (1,0)  \\
    \vec q^{(2)} = (0,1) \\ 
    \vec q^{(-n)} = - \vec q^{(n)} |_{n=1,2} \\
\end{array}
\right \}}
$$

Primary Bravais Lattice vectors

$$
\mathcal B_{\textrm{sq}}^{(1)} = 
\left \{ 
\begin{array}{l}
    \vec a^{(1)} = a_0(1,0)  \\
    \vec a^{(2)} = a_0(0,1)  \\ 
    \vec a^{(-1)},\vec a^{(-2)}
\end{array}
\right \}
$$

$$
\mathcal R_{\textrm{sq}}^{(2)} = 
\left \{ 
\begin{array}{l}
    \vec q^{(3)} = (1,-1)  \\
    \vec q^{(4)} = (1,1) \\ 
    \vec q^{(-n)} = - \vec q^{(n)} |_{n=3,4} \\
\end{array}
\right \}
$$



### 3D body-centered cubic

Lattice constant

$$
a_0 = 2\pi \sqrt {2}
$$

Primary BLVs

$$
\mathcal B_{\textrm{bcc}}^{(1)} = 
{
\left \{ 
\begin{array}{l}
    \vec a^{(1)} = a_0(-1,1,1)/2  \\
    \vec a^{(2)} = a_0(1,-1,1)/2 \\
    \vec a^{(3)} = a_0(1,1,-1)/2\\ 
    \vec a^{(4)} = a_0(1,1,1)/2\\ 
    \vec a^{(-n)}=-\vec a^{(n)}|_{n=1,...,4} \\
\end{array}
\right \}
}
$$

Primary RLVs

$$
\mathcal R_{\textrm{bcc}}^{(1)} = 
{
\left \{ 
\begin{array}{l}
    \vec q^{(1)} = (0,1,1)/\sqrt 2  \\
    \vec q^{(2)} = (1,0,1)/\sqrt 2 \\
    \vec q^{(3)} = (1,1,0)/\sqrt 2\\ 
    \vec q^{(4)} = (0,-1,1)/\sqrt 2\\ 
    \vec q^{(5)} = (-1,0,1)/\sqrt 2\\ 
    \vec q^{(6)} = (-1,1,0)/\sqrt 2\\ 
    \vec q^{(-n)} = - \vec q^{(n)}|_{n=1,...6} \\
\end{array}
\right \}
}
$$



### 3D face-centered cubic

Lattice constant

$$
a_0 = 2\pi \sqrt 3
$$


Primary BLVs

$$
\mathcal B_{\textrm{fcc}}^{(1)} = 
{
\left \{ 
\begin{array}{l}
    \vec a^{(1)} = a_0(0,1,1)/2  \\
    \vec a^{(2)} = a_0(1,0,1)/2 \\
    \vec a^{(3)} = a_0(1,1,0)/2\\ 
    \vec a^{(4)} = a_0(0,-1,1)/2\\ 
    \vec a^{(5)} = a_0(-1,0,1)/2\\ 
    \vec a^{(6)} = a_0(-1,1,0)/2\\ 
    \vec a^{(-n)}=-\vec a^{(n)}|_{n=1,...,6} \\ 
\end{array}
\right \}
}
$$

Primary RLVs

$$
\mathcal R_{\textrm{fcc}}^{(1)} = 
{
\left \{ 
\begin{array}{l}
    \vec q^{(1)} = (-1,1,1)/\sqrt 3  \\
    \vec q^{(2)} = (1,-1,1)/\sqrt 3 \\
    \vec q^{(3)} = (1,1,-1)/\sqrt 3\\ 
    \vec q^{(4)} = (1,1,1)/\sqrt 3\\ 
    \vec q^{(-n)} = - \vec q^{(n)}|_{n=1,...,4}\\
\end{array}
\right \}
}
$$

$$
\mathcal R_{\textrm{fcc}}^{(4/3)} = 
{
\left \{ 
\begin{array}{l}
    \vec q^{(5)} = (2,0,0)/\sqrt 3  \\
    \vec q^{(6)} = (0,2,0)/\sqrt 3 \\
    \vec q^{(7)} = (0,0,2)/\sqrt 3\\ 
    \vec q^{(-n)} = - \vec q^{(n)} |_{n=5,6,7} \\
\end{array}
\right \}
}
$$



### 3D simple cubic

Lattice constant

$$
a_0 = 2\pi
$$

Primary BLVs

$$
\mathcal B_{\textrm{sc}}^{(1)} = 
{
\left \{ 
\begin{array}{l}
    \vec a^{(1)} = a_0(1,0,0)  \\
    \vec a^{(2)} = a_0(0,1,0) \\
    \vec a^{(3)} = a_0(0,0,1)\\ 
    \vec a^{(-n)} = - \vec a^{(n)}|_{n=1,2,3} \\
\end{array}
\right \}
}
$$

Primary RLVs

$$
\mathcal R_{\textrm{sc}}^{(1)} = 
{
\left \{ 
\begin{array}{l}
    \vec q^{(1)} = (1,0,0)  \\
    \vec q^{(2)} = (0,1,0) \\
    \vec q^{(3)} = (0,0,1)\\ 
    \vec q^{(-n)} = - \vec q^{(n)} |_{n=1,2,3}\\
\end{array}
\right \}
}
$$

$$
\mathcal R_{\textrm{sc}}^{(2)} = 
{
\left \{ 
\begin{array}{l}
    \vec q^{(4)} = (0,1,1)  \\
    \vec q^{(5)} = (1,0,1) \\
    \vec q^{(6)} = (1,1,0)\\ 
    \vec q^{(7)} = (0,-1,1)  \\
    \vec q^{(8)} = (-1,0,1) \\
    \vec q^{(9)} = (-1,1,0)\\ 
    \vec q^{(-n)} = - \vec q^{(n)}|_{n=4,...,9} \\\\
\end{array}
\right \}
}
$$

$$\mathcal R_{\textrm{sc}}^{(3)} = 
{
\left \{ 
\begin{array}{l}
    \vec q^{(10)} = (-1,1,1)  \\
    \vec q^{(11)} = (1,-1,1) \\
    \vec q^{(12)} = (1,1,-1)\\ 
    \vec q^{(13)} = (1,1,1)\\ 
    \vec q^{(-n)} = - \vec q^{(n)}|_{n=10,...,13} \\
\end{array}
\right \}
}
$$



## Initialization

The `pfc` instance will be initialized with a list called `eta`, which
consists of the equilibrium values of the amplitudes to begin with.

The elastic constants are defined and saved as
`el_mu, el_lambda, el_gamma`.

### 1D periodic

Default resolution

Default model parameters $(r,\psi_0)$:

Equilibrium amplitude equations



### 2D triangular

Default resolution: $[7,12]^{-1}a_0$

Default model parameters $(r,\psi_0)$: $(-0.3,-0.3)$

Equilibrium amplitude equation [elderModelingElasticPlastic2004](References.md)

$$
\left \{ A= -\frac{1}{5} \psi_0 + \frac{1}{15}\sqrt{- 15r - 36\psi_0^2} \right \}
$$



### 2D square

Default resolution: $[7,7]^{-1}a_0$

Default model parameters $(r,\psi_0)$: $(-0.3,-0.3)$

Equilibrium amplitude equations [emdadiRevisitingPhaseDiagrams2016](References.md)

$$
\left \{
         \begin{array}{rl}
         12 \psi_0^2 A + 48 \psi_0 A B + 36 A^3 + 72 A B^2 + 4A r &=0 \\
         12 \psi_0^2 B + 24 \psi_0 A^2 + 36 B^3 + 72 A^2 B + 4Br  &= 0\\
         \end{array}
\right \}
$$



### 3D body-centered cubic

Default resolution: $[7,7,7]^{-1}a_0$

Default model parameters $(r,\psi_0)$: $(-0.3,-0.325)$

Equilibrium amplitude equations [wuPhasefieldCrystalModeling2007](References.md)

$$
\left \{ A = -\frac{2}{15}\psi_0 + \frac{1}{15} \sqrt{-5r - 11 \psi_0^2} \right \}
$$



### 3D face-centered cubic

Default resolution: $[11,11,11]^{-1}a_0$

Default model parameters $(r,\psi_0)$: $(-0.3,-0.325)$

Equilibrium amplitude equations [wuPhasefieldcrystalModelFcc2010](References.md)

$$
         \left \{
         \begin{array}{rl} 
          27 A^2 + 36 B^2 + 18 B \psi_0 + 3 \psi_0^2 + r &=0 \\
          72 A^2 (4 B + \psi_0) + 90 B^3 + 18 B \psi_0^2 + 6 B r &=0\\
          \end{array}
          \right \}
$$



### 3D simple cubic

Default resolution: $[5,5,5]^{-1}a_0$
 
Default model parameters $(r,\psi_0)$: $(-0.3,-0.325)$

Equilibrium amplitude equations [skogvollStressOrderedSystems2021](References.md)

$$
\left \{
         \begin{array}{rl} 
         15 A^3 + 24 A^2 C + 24 B C (3 B + \psi_0) 
         + 96 AB^2 + 36 AC^2 + 24 AB \psi_0 
         + 3A \psi_0^2 + Ar &= 0, \\
        12 A C (6 B + \psi_0) + 6 A^2 (8 B + \psi_0) 
        +  45 B^3 + 54 BC^2 + 12 B^2 \psi_0 
        + 3B \psi_0^2 + Br &=0  \\
        6 A^3 + 27 A^2 C + 18 A B (3 B + \psi_0) 
        +   81 B^2C + 27 C^3  
        + 3 C \psi_0^2 + Cr &=0 \\
        \end{array}
          \right \}
$$






## Demodulation

$$\eta_n = \langle \psi e^{-\mathbbm i \boldsymbol{q}^{(n)} \cdot \boldsymbol{r}} \rangle$$

## Elasticity

This quantity is the Poisson ratio, under some conditions. I think. To
be fixed. $$\nu = \frac{\lambda}{(d-1)\lambda + 2\mu + \gamma}$$

Elastic constants are saved in these quantities
      pfc.el_mu      pfc.el_lambda      pfc.el_gamma      pfc.el_nu

The equations for calculating the stress tensor are found in Ref.
[@skogvollStressOrderedSystems2021], but we list them below, together
wtih the elastic constants for each of the models.

Following the derivation in Ref. [@skogvollStressOrderedSystems2021], we
get $$\tilde h_{xx} =$$

::: landscape
::: {#tab:elasticity_summary}PFC model         Stress tensor $h_{ij}$                                                                                                                                                                 Elastic constants                                ----------------- -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- --------------------------------------- -- -- -- --1D periodic       $-2\left \langle (\mathcal L_1 \psi) \partial_{xx} \psi \right \rangle$                                                                                                                $\lambda =$                                                                                                                                                                                                                                               $\mu =$                                                                                                                                                                                                                                                   $\gamma = 0$                                     2D triangular     $-2\left \langle (\mathcal L_1 \psi) \partial_{ij} \psi \right \rangle$                                                                                                                $\lambda = 3A^2$                                                                                                                                                                                                                                          $\mu = 3A^2$                                                                                                                                                                                                                                              $\gamma = 0$                                     2D square         $-2\left \langle (\mathcal L_1 \mathcal L_2 \psi)(\mathcal L_1 + \mathcal L_2) \partial_{ij} \psi \right \rangle$                                                                      $\lambda = 16B^2$                                                                                                                                                                                                                                         $\mu = 16B^2$                                                                                                                                                                                                                                             $\gamma = 8A^2-32B^2$                            3D bcc            $-2\left \langle (\mathcal L_1 \psi) \partial_{ij} \psi \right \rangle$                                                                                                                $\lambda = 4 A^2$                                                                                                                                                                                                                                         $\mu = 4 A^2$                                                                                                                                                                                                                                             $\gamma = -4A^2$                                 3D fcc            $-2\left \langle (\mathcal L_1 \mathcal L_{\frac 4 3} \psi)(\mathcal L_1 + \mathcal L_{\frac 4 3}) \partial_{ij} \psi \right \rangle$                                                  $\lambda = \frac{32}{81} A^2$                                                                                                                                                                                                                             $\mu = \frac{32}{81} A^2$                                                                                                                                                                                                                                 $\gamma = \frac{32}{81} (2B^2 - A^2)$            3D simple cubic   $-2\left \langle (\mathcal L_1 \mathcal L_2 \mathcal L_3 \psi)(\mathcal L_2 \mathcal L_3 + \mathcal L_1 \mathcal L_3 + \mathcal L_1 \mathcal L_2) \partial_{ij} \psi \right \rangle$   $\lambda = 16 B^2 + 128 C^2$                                                                                                                                                                                                                              $\mu = 16 B^2 + 128 C^2$                                                                                                                                                                                                                                  $\gamma = 32 A^2 - 16 B^2 - 256 C^2$             
: The stress tensor $h_{ij}$ and its associated elastic constants interms of amplitudes ($A,B,C$) of the mode expansion for different PFCmodels. Here, $\mathcal L_X = X+\nabla^2$. The elastic constants canbe expressed in Voigt notation by $C_{11} = \lambda+2\mu+\gamma$,$C_{12} = \lambda$, $C_{44}=\mu$. Reprinted from Ref.[@skogvollStressOrderedSystems2021] with permission.
:::
:::

$$\nabla \cdot \mathbbm h 
=
\left \langle \tilde \mu_c \nabla \psi - \nabla \tilde f \right \rangle$$

## Equations of motion

### Conserved evolution

The basic equation motion presented in Ref.
[@elderModelingElasticPlastic2004] can be derived by postulating a
simple mechanism for free energy minimzation under the constraint of
mass conservation.

::: tcolorbox
$$\partial_t \psi = \nabla^2 \mu_c,$$ The PFC evolution equation

(`evolve_PFC`)
:::

where

::: tcolorbox
$$\mu_c = 
\frac{\delta \mathcal F}{\delta \psi}
=
\left ( \mathcal L^2 \psi + \texttt r \psi + \texttt t \psi^2 + \texttt v \psi^3 \right )$$
The PFC chemical potential
:::

which gives
$${{\omega }_{\scriptscriptstyle \mathbbm f}}= -\boldsymbol{k}^2 (r + {{\mathcal L}_{\scriptscriptstyle \mathbbm f}}^2)$$
$$N = \nabla^2 (\texttt{t} \psi^2 + \texttt v \psi^3)$$

### Unconserved dynamics

::: tcolorbox
$$\partial_t \psi = - \mu_c$$ The unconserved PFC evolution equation

(`evolve_PFC_unconserved`)
:::

### Evolution at mechanical equilibrium

Historical context.

::: tcolorbox
Step 1:
$$\psi(t+\Delta t) = \textrm{Integrate($\Delta t$):} (\partial_t \psi)$$
Step 2:
$$\psi(t + \Delta t, \boldsymbol{r}) \leftarrow \psi(t + \Delta t, \boldsymbol{r} - \boldsymbol{u}^\delta),$$
where $\boldsymbol{u}^\delta$ is the solution to
$$\boldsymbol{u}^\delta  =$$ The PFC evolution at mechanical equilibrium

(`evolve_PFC_mechanical_equilibrium`)
:::

Note that due to the asymmetry of the elastic constants, this method can
only be used for small deviations of the lattice orientation.

### Hydrodynamic PFC evolution

In Ref. [@skogvollHydrodynamicPhaseField2022], a hydrodynamic approach
was derived. A simplified two-parameter model was proposed

::: tcolorbox
$$\partial_t \psi = \nabla^2 \tilde \mu_c - \boldsymbol{v} \cdot \nabla \psi$$
$$\partial_t \boldsymbol{v} = \frac{1}{\rho_0} (\nabla \cdot \mathbbm h + \Gamma_S \nabla^2 \boldsymbol{v} + \boldsymbol{f}^{\textrm(ext)})$$
The hydrodynamic PFC model

(`evolve_PFC_hydrodynamic`)
:::

We insert for $\mu_c$ and write it in matrix form to emphasize the
linear and non-linear parts $$\partial_t 
\begin{pmatrix}  \psi \\  v_1 \\  v_2 \\  v_3 
\end{pmatrix}
=
\begin{pmatrix}  \nabla^2 (r + \mathcal L^2) \psi \\  \frac{1}{\rho_0}\Gamma_S \nabla^2 v_1 \\  \frac{1}{\rho_0}\Gamma_S \nabla^2 v_2 \\  \frac{1}{\rho_0}\Gamma_S \nabla^2 v_3
\end{pmatrix}
+
\begin{pmatrix}  \nabla^2 (\texttt t \psi^2 + \texttt v \psi^3)  - \boldsymbol{v} \cdot \nabla \psi \\  \frac{1}{\rho_0} \left (  \left \langle \tilde \mu_c \partial_x \psi - \partial_x \tilde f \right \rangle  + f_x^{(ext)}\right )\\  \frac{1}{\rho_0} \left (  \left \langle \tilde \mu_c \partial_y \psi - \partial_y \tilde f \right \rangle  + f_y^{(ext)}\right ) \\  \frac{1}{\rho_0} \left (  \left \langle \tilde \mu_c \partial_z \psi - \partial_z \tilde f \right \rangle  +  f_z^{(ext)} \right )
\end{pmatrix}$$

## Dislocations

The Burgers vector is defined by

::: tcolorbox
$$\oint_{\partial \mathcal M} d \boldsymbol{u} = -\boldsymbol{b}.
\label{eq:Burgers_vector_definition}$$ Burgers vector definition
:::

The minus sign in this convention reflects the fact that we consider the
Burgers vector to be the disconnection error from the *ending* point to
the *starting* point, when going an oriented path around the
dislocation, see Fig.
[\[fig:TypesOfDislocations\]](#fig:TypesOfDislocations){reference-type="ref"
reference="fig:TypesOfDislocations"}.

::: overpic
Figures/TypesOfDislocations.png (0,30) (14,12) (36,30) (46,30)
$\boldsymbol{t}$ (62,5)$x$ (35,12)$y$ (36.5,27)$z$ (68,30)
:::

In three dimensions, the path defining the dislocation is given by the
direction of the dislocation line tangent $\boldsymbol{t}$. Multiplying
this equation by the reciprocal lattice vector $-\boldsymbol{q}^{(n)}$,
we get
$$\oint_{\partial \mathcal M} d (-\boldsymbol{q}^{(n)} \cdot \boldsymbol{u}) = (\boldsymbol{b} \cdot \boldsymbol{q}^{(n)}) \equiv 2\pi s_n,$$
where $s_n$ is the charge associated with the Burgers vector
$\boldsymbol{b}$

::: tcolorbox
$$s_n = \frac{1}{2\pi} \boldsymbol{b} \cdot \boldsymbol{q}^{(n)}.$$
Dislocation charge
:::

Using the primary BLVs from Tab.
[5.2](#tab:crystalLatticeVectors){reference-type="ref"
reference="tab:crystalLatticeVectors"}, we get the charges summarized in
Tab. [5.5](#tab:dislocation_charges){reference-type="ref"
reference="tab:dislocation_charges"}.

::: landscape
::: {#tab:dislocation_charges}Crystal structure                                                       $\cdot \boldsymbol{q}_1$   $\cdot \boldsymbol{q}_2$   $\cdot \boldsymbol{q}_3$   $\cdot \boldsymbol{q}_4$   $\cdot \boldsymbol{q}_5$   $\cdot \boldsymbol{q}_6$   $\cdot \boldsymbol{q}_7$   $\cdot \boldsymbol{q}_8$   $\cdot \boldsymbol{q}_9$   $\cdot \boldsymbol{q}_{10}$   $\cdot \boldsymbol{q}_{11}$   $\cdot \boldsymbol{q}_{12}$   $\boldsymbol{q}_{13}$        ---------------------------------------------------------------------- -------------------------- -------------------------- -------------------------- -------------------------- -------------------------- -------------------------- -------------------------- -------------------------- -------------------------- ----------------------------- ----------------------------- ----------------------------- ----------------------- -- -- --2D tri: $\boldsymbol{b}=\boldsymbol{a}^{(1)} = a_0 (1,0)$                   $\color{red} 1$                  $0$                  $\color{blue}-1$                                                                                                                                                                                                                                                                                                2D tri: $\boldsymbol{b}=\boldsymbol{a}^{(2)} = a_0 (1/2,\sqrt 3/2)$               $0$                  $\color{red} 1$            $\color{blue}-1$                                                                                                                                                                                                                                                                                                2D tri: $\boldsymbol{b}=\boldsymbol{a}^{(3)} = a_0 (1/2,-\sqrt 3/2)$        $\color{red} 1$            $\color{blue}-1$                 $0$                                                                                                                                                                                                                                                                                                       2D sq: $\boldsymbol{b}=\boldsymbol{a}^{(1)} = a_0 (1,0)$                    $\color{red} 1$                  $0$                  $\color{red} 1$            $\color{red} 1$                                                                                                                                                                                                                                                                      2D sq: $\boldsymbol{b}=\boldsymbol{a}^{(2)} = a_0(0,1)$                           $0$                  $\color{red} 1$            $\color{blue}-1$           $\color{red} 1$                                                                                                                                                                                                                                                                      3D bcc: $\boldsymbol{b}=\boldsymbol{a}^{(1)} = a_0/2 (-1,1,1)$              $\color{red} 1$                  $0$                        $0$                        $0$                  $\color{red} 1$            $\color{red} 1$                                                                                                                                                                                                                3D bcc: $\boldsymbol{b}=\boldsymbol{a}^{(2)} = a_0/2 (1,-1,1)$                    $0$                  $\color{red} 1$                  $0$                  $\color{red} 1$                  $0$                  $\color{blue}-1$                                                                                                                                                                                                               3D bcc: $\boldsymbol{b}=\boldsymbol{a}^{(3)} = a_0/2 (1,1,-1)$                    $0$                        $0$                  $\color{red} 1$            $\color{blue}-1$           $\color{blue}-1$                 $0$                                                                                                                                                                                                                      3D bcc: $\boldsymbol{b}=\boldsymbol{a}^{(4)} = a_0/2 (1,1,1)$               $\color{red} 1$            $\color{red} 1$            $\color{red} 1$                  $0$                        $0$                        $0$                                                                                                                                                                                                                      3D fcc: $\boldsymbol{b}=\boldsymbol{a}^{(1)} = a_0/2(0,1,1)$                $\color{red} 1$                  $0$                        $0$                  $\color{red} 1$                  $0$                  $\color{red} 1$            $\color{red} 1$                                                                                                                                                                                     3D fcc: $\boldsymbol{b}=\boldsymbol{a}^{(2)} = a_0/2(1,0,1)$                      $0$                  $\color{red} 1$                  $0$                  $\color{red} 1$            $\color{red} 1$                  $0$                  $\color{red} 1$                                                                                                                                                                                     3D fcc: $\boldsymbol{b}=\boldsymbol{a}^{(3)} = a_0/2 (1,1,0)$                     $0$                        $0$                  $\color{red} 1$            $\color{red} 1$            $\color{red} 1$            $\color{red} 1$                  $0$                                                                                                                                                                                           3D fcc: $\boldsymbol{b}=\boldsymbol{a}^{(4)} = a_0/2(0,-1,1)$                     $0$                  $\color{red} 1$            $\color{blue}-1$                 $0$                        $0$                  $\color{blue}-1$           $\color{red} 1$                                                                                                                                                                                     3D fcc: $\boldsymbol{b}=\boldsymbol{a}^{(5)} = a_0/2 (-1,0,1)$              $\color{red} 1$                  $0$                  $\color{blue}-1$                 $0$                  $\color{blue}-1$                 $0$                  $\color{red} 1$                                                                                                                                                                                     3D fcc: $\boldsymbol{b}=\boldsymbol{a}^{(6)} = a_0/2(-1,1,0)$               $\color{red} 1$            $\color{blue}-1$                 $0$                        $0$                  $\color{blue}-1$           $\color{red} 1$                  $0$                                                                                                                                                                                           3D simple cubic: $\boldsymbol{b}=\boldsymbol{a}^{(1)} = a_0(1,0,0)$         $\color{red} 1$                  $0$                        $0$                        $0$                  $\color{red} 1$            $\color{red} 1$                  $0$                  $\color{blue}-1$           $\color{blue}-1$            $\color{blue}-1$               $\color{red} 1$               $\color{red} 1$            $\color{red} 1$           3D sc: $\boldsymbol{b}=\boldsymbol{a}^{(2)} = a_0 (0,1,0)$                        $0$                  $\color{red} 1$                  $0$                  $\color{red} 1$                  $0$                  $\color{red} 1$            $\color{blue}-1$                 $0$                  $\color{red} 1$              $\color{red} 1$              $\color{blue}-1$               $\color{red} 1$            $\color{red} 1$           3D simple cubic: $\boldsymbol{b}=\boldsymbol{a}^{(3)} = a_0(0,0,1)$               $0$                        $0$                  $\color{red} 1$            $\color{red} 1$            $\color{red} 1$                  $0$                  $\color{red} 1$            $\color{red} 1$                  $0$                    $\color{red} 1$               $\color{red} 1$              $\color{blue}-1$            $\color{red} 1$           
: The charges $s_n$ corresponding to different dislocations (given byone of the primary BLVs). The vertical lines mark the portion of RLVsthat are primary, secondary and tertiary.
:::
:::

Given a PFC configuration, the dislocation density tensor may be
calculated as
$$\alpha_{ij} = \frac{2d}{N\eta_0^2} \sum_{n=1}^N D_i^{(n)} q_j^{(n)}
=
\frac{2 \pi d}{N} \sum_{n=1}^N \rho_i^{(n)} q_j^{(n)}$$ where
$\boldsymbol{D}^{(n)}$ is calculated from
$\boldsymbol{\psi }= (\Re(\eta_n), \Im(\eta_n))$ from the $N$ primary
reciprocal lattice vectors $\boldsymbol{q}^{(n)}$ and
$$\rho^{(n)}_i = \frac{1}{\pi \eta_0^2} D^{(n)}_i$$ In the language of
this
