import os
import sys
sys.path.append(os.path.dirname(os.path.dirname(os.path.abspath(__file__))))
import comfit as cf
import matplotlib.pyplot as plt
import numpy as np

pfc = cf.PhaseFieldCrystal2DTriangular(21, 14)
eta = pfc.calc_amplitudes_with_dislocation_dipole(
dislocation_type=1,
x1=pfc.xmax/3,   y1=pfc.ymax/2,
x2=2*pfc.xmax/3, y2=pfc.ymax/2)
pfc.conf_PFC_from_amplitudes(eta)
pfc.evolve_PFC(100)
eta = pfc.calc_demodulate_PFC()
# pfc.plot_field(pfc.psi)
# pfc.plot_field(np.abs(eta[2]),cmap_symmetric=False)
print(eta[1])
plt.show()